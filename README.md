# Final assignment
This is a project which processes microarray gene expression files and writes a barplot in which the top n expressed genes are shown.
There are 3 classes within this project, that complement each other. 

## Table of contents
- [Packages](#packages)
- [What files to use](#what-files-to-use)
- [Classes](#classes)
- [How to use](#how-to-use)
- [Screenshots](#screenshots)

## Packages
 To use this script you need to have some python libraries installed:

 **```argparse```**
 
 **```matplotlib```**
 
 **```math```**
 
 **```scipy```** 

## What files to use
To use this script you will need a CSV file containing microarray expression data. This script processes the data of these microarary expressions. The gene names have to be in the first row after the second column, the sample names have to be in the first column of each row, the tissue types in the  second columns of each row and the expression data from the 3rd column to the n'th column of each row. 

## Classes
- **```GeneExpressionData```** This class processes microarray expression csv files and puts all necessary information in the so called ```expression_dict``` (dictionary) and the corresponding gene names are stored in a list. With the ```get_expression``` function, the desired gene name needs to be passed through, which is realised via the commandline through parsing. It returns the corresponding gene name with its expression values in f-string format.
 
-  **```StatisticalAnalysis```** This class processes the obtained expression of the csv file further into mean values and subsequently into mean log2 fold change values. It has a couple of functions which require the gene names in a list and the expression values in a ```expression_dict```. With the ```calculate_mean_expression``` function, the desired ```gene``` needs to be passed through via the commandline. With this gene its mean expression values are return in f-string format. In the ```calculate_differential_expression``` function the log2 fold-change values are calculated of the desired ```expression_values1``` and ```expression_values2```, which can be for example ```normal``` or ```HCC``` which are normal tissue type or hepatocellular carcinoma tissue types, respectively. The desired top n of the most expressed up- or downregulated genes, also needs to be passed through as the 3rd argument of this function as ```top_n```.
  
-  **```BarPlotCreator```** With this class the 'Statistical relevance' of samples from microarray expression csv files can be determined. The class uses processed data from the **```StatisticalAnalysis```** class. In the function ```confidence_interval``` the confidence intervals are determined and put in this format ```confidence_interval_dict[gene_name] = fold_change_interval``` for further analysis. The class also contains another function called ```create_barplot``` in which all the obtained and processed data is analysed and pdf files are created which contain barplots and errorbars or up- and downregulated genes (seperate pdf files of up- and downregulated genes are generated).

## How to use
The main script uses a parser where the path of the csv file and the desired top n (up- or down)expressed of one tissue vs another can be specified. The expression_data_class is imported in the main function, and reads the data of the file, and puts the necessary data in a dictionary. 

The following arguments need to be filled with the desired commands:
- **```--file-path```** *In here the path of the required csv file needs to be provided.*

- **```--gene-name```** *To check whether the script works and provides the correct expression data, a specific gene name within the csv file needs to be called on in this argument.*

- **```--gene```** *To visualize the mean expression of a certain gene, this argument needs to be provided with the desired gene name*

- **```--expression-values1```** *The final function of this script is to provide a barplot in which the desired tissue types can be compared. The barplot shows the difference in expression of top n genes, that are over- or underexpressed. In this argument the first tissue type needs to be added.*

- **```--expression-values2```** *In this argument the second tissue type needs to be added (see --expression-values1 for a detailed description of its function)*

- **```--top-n```** *To determine the number of the top genes that are over- and underexpressed, in this argument the number of top genes can be provided. The created barplot displays the top n genes that are over- and underexpressed. It created two different pdf files in which the barplot with corresponding errorbars are displayed.*

## Screenshots
Example output of f-string formatted gene expression values is:
```PS \Final assignment> python main_script.py --file-path Liver_GSE14520_U133A.csv, --gene-name 209220_at, --gene 209220_at, --exp-val1 normal --exp-val2 HCC, --top-n 10
The gene name with name: '209220_at' is found and has the following expression values: [10.4940660132875, 10.6636412511969, 11.7427472834902, 11.2649087811095, 9.93381700180943, 10.7557465502368, 11.2494300186965, 6.67648247137333, 8.90003541582874, 4.72938886949078, 3.78048605652281, 9.67876189098324, 7.63329796918796, 6.47309037566924, 11.5654579886139, 10.9647805919711, 10.4184319592399, 11.8585225531271, 11.4819035079705, 10.5240127332336, 7.77189102976765, 4.08456510628647, 9.63194377610611, 4.05299527902518, 10.7747775580461, 12.071344484071, 4.39614208478133, 10.5362092215352, 9.85698112786293, 11.5015947925273, 10.5901651244397, 11.7398554549644, 11.2068183521744, 11.6968550150837, 8.86301887460982, 4.70621878373046, 11.7779505307171, 9.53683695302376, 9.94469594630157, 11.4205874466946, 13.1906335021293, 10.8300139258962, 11.011323504094, 11.9174112296319, 11.2123293082501, 10.0362749868471, 10.7937911657018, 10.9466402832582, 9.59241878428101, 12.3936874668384, 12.0182947596789, 7.14156068121373, 11.1882895407091, 9.99280528986193, 5.25329684409191, 11.6903455226491, 11.1611467562913, 11.8891175468406, 11.9347566754919, 10.1417852881642, 9.86902972757681, 4.95985526895355, 11.7763182369472, 11.3380935676855, 4.54884479085529, 11.6337643551357, 10.2054242700718, 7.97943830174396, 8.22541873097455, 11.4734558053053, 9.45136258486502, 6.55263441585415, 10.8416877952947, 8.93180891223549, 10.836319256747, 10.2263712734717, 10.4868130984105, 6.77928515833243, 12.4965025592736, 12.1693690637981, 10.6342973740229, 4.33423566562112, 11.9911619080029, 11.9364824144499, 3.62345004188795, 9.17891085384277, 10.7781645908225, 10.1832823155652, 11.874188529199, 5.60385124859264, 12.1163482661897, 10.7798632086808, 4.46017461504225, 4.30432973055282, 8.19316290886916, 11.7570316208892, 11.8976383555778, 11.7355154231408, 11.268761705573, 11.1856803593602, 12.0781706228875, 11.7759631640501, 8.59162631831309, 12.3221901528985, 11.4679684462794, 9.73758110657518, 12.4424514651946, 3.80727983600413, 3.81004128868517, 12.4501936330173, 11.3966488101508, 11.593865942276, 10.9377897227372, 11.3757379074059, 13.00613274099, 8.46513178591873, 12.2898491841201, 7.84545263681353, 10.5402419898836, 11.6002419775376, 10.8077918185677, 10.0302090248804, 10.5913065943127, 10.9999333170987, 10.9976872392046, 11.5888672325705, 4.8411442247439, 6.23514230135787, 4.21971578946274, 4.13295841007302, 12.0023595567773, 10.7136260978574, 4.66851097123617, 10.8701591652484, 6.34662241139667, 11.2114531640215, 11.0687475008758, 9.63328981925275, 9.70521980256477, 8.2988537458341, 11.1845476388377, 12.3172525985295, 10.6138089543614, 11.7039962024902, 10.7300923775331, 10.9776871252214, 12.5008811346863, 7.64253856963773, 12.3402470746576, 10.6942530486045, 10.2605120111112, 4.23886805388573, 10.3653407016874, 11.5338212246932, 11.2097345819839, 12.384310711133, 11.4796738139523, 11.1582101780957, 6.62350160108156, 10.1485463668817, 10.9561548073904, 7.82548315130305, 11.7866803490062, 12.2422930378448, 12.4334451087729, 6.82395525612082, 11.0694666095011, 10.3262697574874, 8.24704661662486, 11.0969558006977, 10.3545847072807, 12.0413505116485, 11.4271411187231, 4.12651096149663, 10.9465788989303, 7.08976533559187, 11.1618965868783, 5.1393074103469, 11.0855726748598, 6.96289268819411, 12.4971930906127, 4.86314053616212, 3.43372038182632, 3.68997839453116, 3.8710165774469, 4.43624051160981, 4.15527546909756, 3.86172603063048, 11.6670236297968, 4.0130139274712, 3.84072877779302, 3.74530735723605, 4.45318122157111, 4.70601293364183, 5.50702299249493, 6.51592484931317, 3.84088775720547, 3.93809259341416, 3.59810794200786, 3.97327366117164, 4.57104904625485, 4.07122895783167, 4.53292631510191, 4.96838312620465, 4.90178935255199, 5.00846148227195, 3.97615233967699, 4.26820521413388, 4.03636578942668, 8.66738743620344, 5.8264027158171, 5.06634038203052, 4.16401551147413, 8.08653995439115, 4.14611450936236, 5.39189553104433, 3.9044727716251, 5.95952078658357, 4.63530575983033, 5.37315032030937, 3.78338041970866, 4.27390251991762, 4.04249093885862, 4.28663438912017, 4.32259936166916, 4.45589043288277, 4.15463897321791, 7.48465391932899, 4.62132699099632, 8.23932414276604, 5.24414089779008, 4.17218382232077, 3.62473330130674, 4.20963679320401, 5.05750874853501, 5.76087681958635, 4.42127787874316, 7.04304851235022, 4.67409964360305, 4.11693175564284, 3.8567052042389, 3.99275264311846, 4.93994031436651, 5.79207165607955, 4.33950398297925, 4.64224124452421, 4.48422396732267, 3.84205151345684, 4.30532692947373, 4.49639142135206, 5.1857171889176, 4.48173010180812, 4.03327822299817, 4.69573907761391, 4.37020093103214, 4.22449949507229, 5.05650475308994, 4.53393308146202, 3.64401780027477, 4.57533112516258, 6.36943435739946, 6.47855142526733, 6.27355472743887, 5.53915982434028, 4.40356331143487, 6.20936832069194, 4.79871755868614, 6.36490291093565, 4.24782431087643, 3.93334151051813, 4.49987424053711, 7.26659692594402, 4.94909664438071, 7.31418229389831, 6.74393687159344, 5.18142900597795, 4.20800110374593, 5.84249570025342, 8.28136568809108, 10.0251124685493, 4.16707133624502, 8.30826487247393, 3.81284586506461, 4.4088570558428, 5.03889576138484, 4.60370559874444, 4.27752921506502, 3.84572175559404, 4.71523928588742, 5.94515971747392, 7.25971398392744, 4.55062524853052, 4.4108987542362, 6.29810302350521, 4.7785169789828, 5.93563010063282, 4.34148647809891, 3.43851795130577, 4.20751184828735, 4.92925398679969, 4.02277163791919, 4.64306934050655, 4.43722361777348, 4.33799281542202, 5.16706745092565, 4.43406534727771, 5.69625004630765, 4.34917643038224, 5.06007800959899, 5.78659952658506, 4.02572942734026, 4.4824768409338, 7.81171294884382, 4.09681534304251, 4.41234100672263, 4.62667520253074, 4.42102393323679, 4.45093971446655, 5.7425206781232, 5.09118409317936, 4.13160614408794, 5.75343420413555, 4.36167885936059, 4.45764829360019, 3.79945499903509, 5.6349750335809, 4.39632572403171, 4.27959003086947, 6.02736569656513, 4.70586755351954, 4.39474263843341, 4.52686810581742, 4.23256634756901, 5.28515239681059, 4.08804741892551, 8.90604761751525, 5.10518688324206, 3.70295881875057, 7.63186509086251, 4.45056813380422, 3.7420290143124, 5.94644226175554, 4.24751043565771, 4.36379778087992, 5.14721670588358, 4.00826769995237, 4.26182235779127, 7.84702186857535, 4.32290536677763, 4.26145811282546, 4.68791898113811, 4.61285942651688, 4.08762648504358, 4.32328400897691, 12.4684869297654, 4.24999388455664, 4.51207500065396]
The gene name with name: '209220_at' is found and has the following mean expression value: 7.427340320636849```

Examples of output files of down- and upregulated genes in a microarray experiment with normal vs hepatocellular cancer are:


**Downregulated genes**
![Downreg](https://github.com/josvandam0/Final-Assignment/assets/131524850/30c65f6d-0ea6-49f5-9b62-de93e6f309f4)

**Upregulated genes**
![Upreg](https://github.com/josvandam0/Final-Assignment/assets/131524850/4470c399-9806-45fa-9bfe-cbd09a26f8c3)
